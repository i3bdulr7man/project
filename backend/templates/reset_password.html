{% extends "base.html" %}
{% block title %}إعادة تعيين كلمة المرور{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="card shadow-sm p-4 col-md-6 offset-md-3">
        <h4 class="mb-3">إعادة تعيين كلمة المرور</h4>
        <form method="post">
            <input type="hidden" name="token" value="{{ token }}">
            <div class="mb-3">
                <label for="password" class="form-label">كلمة المرور الجديدة</label>
                <input type="password" name="password" id="password" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="password2" class="form-label">تأكيد كلمة المرور</label>
                <input type="password" name="password2" id="password2" class="form-control" required>
            </div>
            {% if error %}
                <div class="alert alert-danger text-center">{{ error }}</div>
            {% endif %}
            <button type="submit" class="btn btn-success w-100">تحديث كلمة المرور</button>
        </form>
    </div>
</div>
<script>
document.querySelector("form").addEventListener("submit", function (e) {
    const password = document.getElementById("password").value;
    const password2 = document.getElementById("password2").value;
    const error = [];

    if (password.length < 12 || password.length > 64) {
        error.push("كلمة المرور يجب أن تكون بين 12 و 64 حرفًا.");
    }

    if (password !== password2) {
        error.push("كلمتا المرور غير متطابقتين.");
    }

    if (error.length > 0) {
        e.preventDefault();
        alert(error.join("\n"));
    }
});
</script>

{% endblock %}
